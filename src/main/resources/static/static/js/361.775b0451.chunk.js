"use strict";(self.webpackChunksalary_management_frontend=self.webpackChunksalary_management_frontend||[]).push([[361],{7361:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});var n=s(5043),l=s(9722),a=s(5475),i=s(579);const r=function(){var e,t,r,d,c,o;const[h,m]=(0,n.useState)([]),[x,j]=(0,n.useState)(""),[u,g]=(0,n.useState)(null),[p,y]=(0,n.useState)(!0),[v,N]=(0,n.useState)(null),[S]=(0,a.ok)(),[f,b]=(0,n.useState)([]);(0,n.useEffect)(()=>{l.A.get("/api/employee-masters").then(e=>b(e.data||[])).catch(()=>b([]))},[]),(0,n.useEffect)(()=>{(async()=>{try{const e=await l.A.get("/api/employees");m(e.data||[])}catch(e){N("Failed to load employees"),console.error(e)}finally{y(!1)}})()},[]);const[w,D]=(0,n.useState)(""),[I,C]=(0,n.useState)(""),[A,E]=(0,n.useState)([]);(0,n.useEffect)(()=>{const e=S.get("month");e&&/^\d{4}-\d{2}$/.test(e)&&D(e)},[S]),(0,n.useEffect)(()=>{var e;const t=!(!w||!w.trim()),s=!(!I||!String(I).trim());if(!t||!s)return E([]),void j("");const n=f.find(e=>String(e.employeeId).trim().toLowerCase()===String(I).trim().toLowerCase()),l=null===n||void 0===n||null===(e=n.employeeId)||void 0===e?void 0:e.toString().trim().toLowerCase(),a=null===w||void 0===w?void 0:w.toString().trim();let i=h;l&&(i=i.filter(e=>{var t;const s=(null!==(t=e.employeeId)&&void 0!==t?t:"").toString().trim().toLowerCase(),a=!e.employeeId&&(null===n||void 0===n?void 0:n.name)&&(null===e||void 0===e?void 0:e.name)&&n.name.trim()===e.name.trim();return s===l||a})),a&&(i=i.filter(e=>(e=>{if(!e)return"";try{const t=new Date(e);if(isNaN(t.getTime())){const t=String(e);return t.length>=7?t.substring(0,7):""}const s=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0");return"".concat(s,"-").concat(n)}catch(t){return""}})(e.salaryDate)===a)),i=i.slice().sort((e,t)=>{const s=new Date(e.salaryDate||0).getTime();return new Date(t.salaryDate||0).getTime()-s}),E(i),j(i.length?String(i[0].id):"")},[w,I,h,f]),(0,n.useEffect)(()=>{const e=h.find(e=>String(e.id)===String(x));g(e||null)},[x,h]);const L=e=>Number(null!==e&&void 0!==e?e:0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}),k=e=>Math.round(Number(null!==e&&void 0!==e?e:0));if(p)return(0,i.jsx)("div",{className:"text-center mt-4",children:"Loading..."});if(v)return(0,i.jsx)("div",{className:"alert alert-danger mt-3",children:v});const P=!!(w&&w.trim()&&I&&String(I).trim());return(0,i.jsxs)("div",{className:"payslip-page",children:[(0,i.jsxs)("div",{className:"payslip-header no-print",children:[(0,i.jsx)("h2",{children:"Salary Slip"}),(0,i.jsxs)("div",{className:"payslip-actions",children:[(0,i.jsx)(a.N_,{to:"/employees",className:"btn btn-secondary btn-rounded",children:"Back to List"}),(0,i.jsx)("button",{type:"button",className:"btn btn-primary btn-rounded",onClick:()=>window.print(),children:"Print"}),(0,i.jsx)("button",{className:"btn btn-outline-secondary no-print",onClick:async()=>{const e=document.getElementById("print-area");if(!e)return;const t=(await s.e(239).then(s.t.bind(s,5239,23))).default,n=(await s.e(762).then(s.bind(s,7762))).default,l=await t(e,{scale:2,useCORS:!0}),a=l.toDataURL("image/png"),i=new n("p","mm","a4"),r=i.internal.pageSize.getWidth(),d=l.height*r/l.width;i.addImage(a,"PNG",0,0,r,d),i.save("Payslip_".concat(x||"employee",".pdf"))},children:"Download PDF"})]})]}),(0,i.jsxs)("div",{className:"payslip-selector no-print",style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,alignItems:"end"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"monthSelect",children:"Select Month"}),(0,i.jsx)("input",{id:"monthSelect",type:"month",value:w,onChange:e=>D(e.target.value)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"employeeMasterSelect",children:"Select Employee"}),(0,i.jsxs)("select",{id:"employeeMasterSelect",value:I,onChange:e=>C(e.target.value),children:[(0,i.jsx)("option",{value:"",children:"-- Select --"}),f.map(e=>{const t=[e.name,e.employeeId].filter(Boolean).join(" - ");return(0,i.jsx)("option",{value:e.employeeId||"",children:t},e.employeeId||e.id||t)})]})]})]}),u?(0,i.jsx)("div",{className:"payslip-container",id:"print-area",children:(0,i.jsxs)("div",{className:"payslip-card",children:[(0,i.jsxs)("div",{className:"classic-header",children:[(0,i.jsx)("img",{className:"brand-logo",src:"/Logo.PNG",alt:"Company logo",onError:e=>{"1"!==e.target.dataset.triedLower?(e.target.dataset.triedLower="1",e.target.src="/logo.png"):e.target.style.display="none"}}),(0,i.jsxs)("div",{className:"company-block",children:[(0,i.jsx)("div",{className:"company-title",children:"Anjo Aqua World"}),(0,i.jsx)("div",{children:"219/40 Kamaraj Road, Kumbakonam-612001"}),(0,i.jsx)("div",{children:"Phone: 81 44 22 77 22"})]})]}),(0,i.jsx)("div",{className:"classic-title",children:"Pay Slip"}),(0,i.jsx)("table",{className:"payslip-classic",children:(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Employee Name"}),(0,i.jsx)("td",{children:null!==(e=u.name)&&void 0!==e?e:""}),(0,i.jsx)("th",{children:"Employee ID."}),(0,i.jsx)("td",{children:null!==(t=u.employeeId)&&void 0!==t?t:null!==(r=null===(d=f.find(e=>e.name===u.name))||void 0===d?void 0:d.employeeId)&&void 0!==r?r:""})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Designation"}),(0,i.jsx)("td",{children:null!==(c=u.designation)&&void 0!==c?c:""}),(0,i.jsx)("th",{children:"Month & Year"}),(0,i.jsx)("td",{children:(e=>{if(!e)return"";const t=new Date(e);if(isNaN(t.getTime()))return e;const s=t.toLocaleString("default",{month:"short"}),n=String(t.getFullYear()).slice(2);return"".concat(s,"-").concat(n)})(u.salaryDate)||"\u2014"})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Days Working"}),(0,i.jsx)("td",{children:null!==(o=u.days)&&void 0!==o?o:""}),(0,i.jsx)("th",{}),(0,i.jsx)("td",{})]})]})}),((e,t)=>{const s=(null!==(e=u.basicSalary)&&void 0!==e?e:0)+(null!==(t=u.hra)&&void 0!==t?t:0);return(0,i.jsxs)("table",{className:"payslip-classic two-col",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Earnings"}),(0,i.jsx)("th",{className:"right",children:"Amount"}),(0,i.jsx)("th",{children:"Deductions"}),(0,i.jsx)("th",{className:"right",children:"Amount"})]})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"Basic+HRA"}),(0,i.jsx)("td",{className:"right",children:L(s)}),(0,i.jsx)("td",{children:"ESS"}),(0,i.jsx)("td",{className:"right",children:k(u.professionalTax)})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"Conveyance"}),(0,i.jsx)("td",{className:"right",children:L(u.conveyanceAllowance)}),(0,i.jsx)("td",{children:"Advance"}),(0,i.jsx)("td",{className:"right",children:L(u.advance)})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"Sales Incentive"}),(0,i.jsx)("td",{className:"right",children:L(u.performanceIncentive)}),(0,i.jsx)("td",{children:"Loan"}),(0,i.jsx)("td",{className:"right",children:L(u.loanDeduction)})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"Per Call Incentive"}),(0,i.jsx)("td",{className:"right",children:L(u.perCall)}),(0,i.jsx)("td",{children:"Sales Debits"}),(0,i.jsx)("td",{className:"right",children:L(u.salesDebits)})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"Attendance Incentive"}),(0,i.jsx)("td",{className:"right",children:L(u.attendanceAllowance)}),(0,i.jsx)("td",{children:"Underperformance"}),(0,i.jsx)("td",{className:"right",children:L(u.underPerformance)})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"Spl Allowance"}),(0,i.jsx)("td",{className:"right",children:L(u.specialAllowance)}),(0,i.jsx)("td",{children:"Others"}),(0,i.jsx)("td",{className:"right",children:L(u.otherDeduction)})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"Other Allowance"}),(0,i.jsx)("td",{className:"right",children:L(u.otherAllowance)}),(0,i.jsx)("td",{}),(0,i.jsx)("td",{})]}),(0,i.jsxs)("tr",{className:"bold",children:[(0,i.jsx)("td",{children:"Gross Salary"}),(0,i.jsx)("td",{className:"right",children:L(u.grossSalary)}),(0,i.jsx)("td",{children:"Total Deductions"}),(0,i.jsx)("td",{className:"right",children:k(u.totalDeduction)})]}),(0,i.jsxs)("tr",{className:"bold",children:[(0,i.jsx)("td",{colSpan:"2"}),(0,i.jsx)("td",{children:"Net salary"}),(0,i.jsx)("td",{className:"right",children:k(u.netSalary)})]})]})]})})(),(0,i.jsx)("div",{style:{height:"48px"}}),(0,i.jsxs)("div",{className:"signature-row",children:[(0,i.jsx)("div",{children:"Employee Signature"}),(0,i.jsx)("div",{children:"Manager"})]})]})}):P?(0,i.jsx)("div",{className:"alert alert-warning",children:"No data available for selected period"}):(0,i.jsx)("div",{className:"payslip-hint",children:"Please select month and employee to view payslip."})]})}}}]);
//# sourceMappingURL=361.775b0451.chunk.js.map