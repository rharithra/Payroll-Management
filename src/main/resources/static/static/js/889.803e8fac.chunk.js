"use strict";(self.webpackChunksalary_management_frontend=self.webpackChunksalary_management_frontend||[]).push([[889],{8889:(e,a,l)=>{l.r(a),l.d(a,{default:()=>c});var t=l(9379),n=l(5043),r=l(5475),s=l(9722),o=l(579);const c=function(){const[e,a]=(0,n.useState)([]),[c,i]=(0,n.useState)(!0),[d,y]=(0,n.useState)(null),b=new Date,u=b.getFullYear(),m=Array.from({length:11},(e,a)=>u-5+a),[p,k]=(0,n.useState)(b.getMonth()+1),[h,g]=(0,n.useState)(u),[x,v]=(0,n.useState)(0),[S,f]=(0,n.useState)(50),[w,A]=(0,n.useState)(0);(0,n.useEffect)(()=>{D()},[p,h,x,S]);const D=async()=>{i(!0),y(null);try{const e=await s.A.get("/api/employees?year=".concat(h,"&month=").concat(p,"&page=").concat(x,"&size=").concat(S));e.data&&e.data.content?(a(e.data.content),A(e.data.totalPages)):(a(e.data),A(1)),i(!1)}catch(e){y("Error fetching employee data"),i(!1),console.error("Error fetching employees:",e)}},N=async()=>{const e=localStorage.getItem("role")||"";if("EMPLOYEE"!==e&&"ADMIN"!==e)return void alert("Login required");const a=C.filter(e=>{const a=String(e.status||"").toUpperCase();return"APPROVED"!==a&&"SUBMITTED"!==a});if(0!==a.length)try{await Promise.all(a.map(e=>s.A.post("/api/employees/".concat(e.id,"/submit")))),D(),alert("Submitted ".concat(a.length," row(s)"))}catch(n){var l,t;alert((null===n||void 0===n||null===(l=n.response)||void 0===l||null===(t=l.data)||void 0===t?void 0:t.message)||"Bulk submit failed")}else alert("No rows eligible to submit")},j=async()=>{if("ADMIN"!==(localStorage.getItem("role")||""))return void alert("Only admin can approve");const e=C.filter(e=>"SUBMITTED"===String(e.status||"").toUpperCase());if(0!==e.length)try{await Promise.all(e.map(e=>s.A.post("/api/employees/".concat(e.id,"/approve")))),D(),alert("Approved ".concat(e.length," row(s)"))}catch(t){var a,l;alert((null===t||void 0===t||null===(a=t.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.message)||"Bulk approve failed")}else alert("No rows eligible to approve")};if(c)return(0,o.jsx)("div",{className:"text-center mt-5",children:(0,o.jsx)("div",{className:"spinner-border"})});if(d)return(0,o.jsx)("div",{className:"alert alert-danger mt-3",children:d});const P=e=>{if(!e)return"";const a=new Date(e);if(isNaN(a.getTime()))return e;const l=String(a.getDate()).padStart(2,"0"),t=String(a.getMonth()+1).padStart(2,"0"),n=a.getFullYear();return"".concat(l,"-").concat(t,"-").concat(n)},E=[{key:"employeeId",label:"Employee ID"},{key:"name",label:"Employee Name"},{key:"designation",label:"Designation"},{key:"department",label:"Department"},{key:"role",label:"Role"},{key:"days",label:"Days"},{key:"basicSalary",label:"Basic Salary"},{key:"hra",label:"HRA"},{key:"dearnessAllowance",label:"Dearness Allowance"},{key:"conveyanceAllowance",label:"Conveyance"},{key:"specialAllowance",label:"Special Allowance"},{key:"leads",label:"Leads"},{key:"performanceIncentive",label:"Performance Incentive"},{key:"perCall",label:"Per-call"},{key:"areaAllowance",label:"Area Allowance"},{key:"os",label:"OS"},{key:"roadshow",label:"Roadshow Promo"},{key:"review",label:"Review"},{key:"dresscode",label:"Dresscode"},{key:"attendanceAllowance",label:"Attendance Allowance"},{key:"arrears",label:"Arrears"},{key:"bonus",label:"Bonus"},{key:"otherAllowance",label:"Other Allowance"},{key:"grossSalary",label:"Gross Salary"},{key:"professionalTax",label:"Professional Tax"},{key:"incomeTax",label:"Income Tax"},{key:"providentFund",label:"PF"},{key:"advance",label:"Advance"},{key:"loanDeduction",label:"Loan Deduction"},{key:"salesDebits",label:"Sales Debits"},{key:"underPerformance",label:"Under Performance"},{key:"otherDeduction",label:"Other Deduction"},{key:"totalDeduction",label:"Total Deduction"},{key:"netSalary",label:"Net Salary"},{key:"salaryDate",label:"Salary Date"},{key:"status",label:"Status"}],C=(e||[]).filter(e=>E.some(a=>{return null!==(l=e[a.key])&&void 0!==l&&("string"!==typeof l||""!==l.trim());var l})),I=[{key:"name",label:"Employee Name"},{key:"designation",label:"Designation"},{key:"days",label:"Days"},{key:"basicSalary",label:"Basic Salary"},{key:"hra",label:"HRA"},{key:"dearnessAllowance",label:"Dearness Allowance"},{key:"conveyanceAllowance",label:"Conveyance"},{key:"specialAllowance",label:"Special Allowance"},{key:"leads",label:"Leads"},{key:"performanceIncentive",label:"Performance Incentive"},{key:"perCall",label:"Per-call"},{key:"areaAllowance",label:"Area Allowance"},{key:"os",label:"OS"},{key:"roadshow",label:"Roadshow Promo"},{key:"review",label:"Review"},{key:"dresscode",label:"Dresscode"},{key:"attendanceAllowance",label:"Attendance Allowance"},{key:"arrears",label:"Arrears"},{key:"bonus",label:"Bonus"},{key:"otherAllowance",label:"Other Allowance"},{key:"grossSalary",label:"Gross Salary"},{key:"professionalTax",label:"Professional Tax"},{key:"advance",label:"Advance"},{key:"loanDeduction",label:"Loan Deduction"},{key:"salesDebits",label:"Sales Debits"},{key:"underPerformance",label:"Under Performance"},{key:"otherDeduction",label:"Other Deduction"},{key:"totalDeduction",label:"Total Deduction"},{key:"netSalary",label:"Net Salary"},{key:"status",label:"Status"}],T=e=>{if(null==e)return 0;const a=String(e).replace(/,/g,"").trim(),l=Number(a);return Number.isFinite(l)?l:0},M=e=>Math.round(T(e)),O=e=>Math.round(T(e)),_=(C||[]).reduce((e,a)=>e+T(a.netSalary),0);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{children:(0,o.jsxs)("div",{className:"actions-bar no-print",children:[(0,o.jsx)(r.N_,{to:"/add",className:"btn btn-primary btn-rounded",children:"Add Salary Details"}),(0,o.jsx)("button",{type:"button",onClick:async()=>{var e,a;const n=await l.e(238).then(l.bind(l,1238)),r=C.map(e=>{const a={};return I.forEach(l=>{a[l.label]="salaryDate"===l.key?P(e[l.key]):"professionalTax"===l.key?M(e[l.key]):"netSalary"===l.key||"totalDeduction"===l.key?O(e[l.key]):e[l.key]}),a["Salary Date"]=P(e.salaryDate),a}),s=I.find(e=>"netSalary"===e.key),o=null!==(e=null===(a=I[0])||void 0===a?void 0:a.label)&&void 0!==e?e:"Info",c=(0,t.A)({[o]:"Total Net Salary"},s?{[s.label]:Number(_.toFixed(2))}:{});r.push(c);const i=n.utils.json_to_sheet(r),d=n.utils.book_new();n.utils.book_append_sheet(d,i,"Employees"),n.writeFile(d,"employees_".concat((new Date).toISOString().slice(0,10),".xlsx"))},className:"btn btn-secondary btn-rounded",children:"Download Excel"}),(0,o.jsx)("button",{type:"button",onClick:()=>window.print(),className:"btn btn-outline-secondary btn-rounded",children:"Print"}),(0,o.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",marginLeft:"auto"},children:[(0,o.jsx)("select",{className:"form-select",style:{width:"auto",display:"inline-block",padding:"6px 12px",fontSize:"14px"},value:p,onChange:e=>{k(Number(e.target.value)),v(0)},children:["January","February","March","April","May","June","July","August","September","October","November","December"].map((e,a)=>(0,o.jsx)("option",{value:a+1,children:e},a))}),(0,o.jsx)("select",{className:"form-select",style:{width:"auto",display:"inline-block",padding:"6px 12px",fontSize:"14px"},value:h,onChange:e=>{g(Number(e.target.value)),v(0)},children:m.map(e=>(0,o.jsx)("option",{value:e,children:e},e))})]}),(()=>{const e=localStorage.getItem("role")||"";return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{type:"button",onClick:N,className:"btn btn-outline-primary btn-rounded",children:"Submit"}),"ADMIN"===e&&(0,o.jsx)("button",{type:"button",onClick:j,className:"btn btn-success btn-rounded",style:{marginLeft:8},children:"Approve"})]})})()]})}),(0,o.jsx)("div",{className:"table-container",children:(0,o.jsxs)("table",{className:"table table-striped table-bordered salary-table",children:[(0,o.jsx)("thead",{className:"table-dark",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{className:"no-print",children:"Actions"}),I.map(e=>(0,o.jsx)("th",{children:e.label},e.key))]})}),(0,o.jsx)("tbody",{children:C.length>0?C.map(e=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"no-print",children:(()=>{const a=localStorage.getItem("role")||"",l="APPROVED"===String(e.status||"").toUpperCase(),t=(String(e.status||"").toUpperCase(),"EMPLOYEE"===a&&l);return(0,o.jsxs)("div",{className:"btn-group",children:[(0,o.jsx)(r.N_,{to:"/edit/".concat(e.id),className:"btn btn-sm ".concat(t?"btn-secondary":"btn-warning"," me-1"),"aria-disabled":t,onClick:e=>{t&&e.preventDefault()},children:"Edit"}),(0,o.jsx)("button",{onClick:()=>!t&&(async e=>{if(window.confirm("Are you sure you want to delete this employee?"))try{await s.A.delete("/api/employees/".concat(e)),D()}catch(a){console.error("Error deleting employee:",a)}})(e.id),className:"btn btn-sm ".concat(t?"btn-secondary":"btn-danger"),disabled:t,children:"Delete"})]})})()}),I.map(a=>{var l;return(0,o.jsx)("td",{children:"salaryDate"===a.key?P(e[a.key]):"professionalTax"===a.key?M(e[a.key]):"netSalary"===a.key||"totalDeduction"===a.key?O(e[a.key]):null!==(l=e[a.key])&&void 0!==l?l:""},a.key)})]},e.id)):(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:I.length+1,className:"text-center",children:"No employees found"})})}),(0,o.jsx)("tfoot",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"no-print"}),I.map(e=>(0,o.jsx)("td",{children:"netSalary"===e.key?Math.round(_):""},e.key))]})})]})}),(0,o.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-3 no-print",children:[(0,o.jsxs)("div",{children:["Page ",x+1," of ",w||1]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{className:"btn btn-secondary me-2",disabled:0===x,onClick:()=>v(e=>Math.max(0,e-1)),children:"Previous"}),(0,o.jsx)("button",{className:"btn btn-secondary",disabled:x>=(w||1)-1,onClick:()=>v(e=>e+1),children:"Next"})]})]})]})}}}]);
//# sourceMappingURL=889.803e8fac.chunk.js.map